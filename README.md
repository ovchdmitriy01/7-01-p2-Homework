# Домашнее задание к занятию «Ansible.Часть 2»

### Оформление домашнего задания

1. Домашнее задание выполните в [Google Docs](https://docs.google.com/) и отправьте на проверку ссылку на ваш документ в личном кабинете.  
1. В названии файла укажите номер лекции и фамилию студента. Пример названия:  Ansible. Часть 2 — Александр Александров.
1. Перед отправкой проверьте, что доступ для просмотра открыт всем, у кого есть ссылка. Если нужно прикрепить дополнительные ссылки, добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

Данное ДЗ выполнялось при подключении к 1 ВМ. Проблема с подключением к 2м на данный момент не решена, будет разбираться с преподавателем.
Ссылка на предыдущую ДЗ:
https://github.com/ovchdmitriy01/7-01_Homework

### Задание 1

**Выполните действия, приложите файлы с плейбуками и вывод выполнения.**

Напишите три плейбука. При написании рекомендуем использовать текстовый редактор с подсветкой синтаксиса YAML.

Плейбуки должны: 

1. Скачать какой-либо архив, создать папку для распаковки и распаковать скаченный архив. Например, можете использовать [официальный сайт](https://kafka.apache.org/downloads) и зеркало Apache Kafka. При этом можно скачать как исходный код, так и бинарные файлы, запакованные в архив — в нашем задании не принципиально.

<a href="https://ibb.co/xhzV6c9"><img src="https://i.ibb.co/xhzV6c9/7-2-1-1.png" alt="7-2-1-1" border="0"></a>
<a href="https://ibb.co/T2PZhHt"><img src="https://i.ibb.co/T2PZhHt/7-2-1-2.png" alt="7-2-1-2" border="0"></a>

2. Установить пакет tuned из стандартного репозитория вашей ОС. Запустить его, как демон — конфигурационный файл systemd появится автоматически при установке. Добавить tuned в автозагрузку.

<a href="https://ibb.co/SwJ9V1Q"><img src="https://i.ibb.co/SwJ9V1Q/7-2-1-3.png" alt="7-2-1-3" border="0"></a>
<a href="https://ibb.co/SVpwxkK"><img src="https://i.ibb.co/SVpwxkK/7-2-1-4.png" alt="7-2-1-4" border="0"></a>
<a href="https://ibb.co/Mh22kKs"><img src="https://i.ibb.co/Mh22kKs/7-2-1-5.png" alt="7-2-1-5" border="0"></a>

3. Изменить приветствие системы (motd) при входе на любое другое. Пожалуйста, в этом задании используйте переменную для задания приветствия. Переменную можно задавать любым удобным способом.

<a href="https://ibb.co/7GZWY4L"><img src="https://i.ibb.co/7GZWY4L/7-2-1-6.png" alt="7-2-1-6" border="0"></a>
<a href="https://ibb.co/nsVmzT2"><img src="https://i.ibb.co/nsVmzT2/7-2-1-7.png" alt="7-2-1-7" border="0"></a>

### Задание 2

**Выполните действия, приложите файлы с модифицированным плейбуком и вывод выполнения.** 

Модифицируйте плейбук из пункта 3, задания 1. В качестве приветствия он должен установить IP-адрес и hostname управляемого хоста, пожелание хорошего дня системному администратору. 

<a href="https://ibb.co/YRsQqHF"><img src="https://i.ibb.co/YRsQqHF/7-2-2-1.png" alt="7-2-2-1" border="0"></a>
<a href="https://ibb.co/gzYjLbq"><img src="https://i.ibb.co/gzYjLbq/7-2-2-2.png" alt="7-2-2-2" border="0"></a>

### Задание 3

**Выполните действия, приложите архив с ролью и вывод выполнения.**

Ознакомьтесь со статьёй [«Ansible - это вам не bash»](https://habr.com/ru/post/494738/), сделайте соответствующие выводы и не используйте модули **shell** или **command** при выполнении задания.

Создайте плейбук, который будет включать в себя одну, созданную вами роль. Роль должна:

1. Установить веб-сервер Apache на управляемые хосты.
2. Сконфигурировать файл index.html c выводом характеристик каждого компьютера как веб-страницу по умолчанию для Apache. Необходимо включить CPU, RAM, величину первого HDD, IP-адрес. Используйте [Ansible facts](https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_vars_facts.html) и [jinja2-template](https://linuxways.net/centos/how-to-use-the-jinja2-template-in-ansible/)
3. Открыть порт 80, если необходимо, запустить сервер и добавить его в автозагрузку.
4. Сделать проверку доступности веб-сайта (ответ 200, модуль uri).

В качестве решения:
- предоставьте плейбук, использующий роль;
- разместите архив созданной роли у себя на Google диске и приложите ссылку на роль в своём решении;
- предоставьте скриншоты выполнения плейбука;
- предоставьте скриншот браузера, отображающего сконфигурированный index.html в качестве сайта.

### Ответ

Ссылка на все плейбуки и роли - https://drive.google.com/drive/folders/1hb0v0ZZ3eALVzBfMwRZodfIu42mMA7_W?usp=drive_link

Содержание файла плейбука.

<a href="https://ibb.co/0G9bbHx"><img src="https://i.ibb.co/0G9bbHx/7-2-3-1.png" alt="7-2-3-1" border="0"></a>

Содержание файла Index.html.j2.

<a href="https://ibb.co/7bQZ59Z"><img src="https://i.ibb.co/7bQZ59Z/7-2-3-2.png" alt="7-2-3-2" border="0"></a>

Установка Apache, замена файла Index.html, перезауск Apache.

<a href="https://ibb.co/DDjXK78"><img src="https://i.ibb.co/DDjXK78/7-2-3-3.png" alt="7-2-3-3" border="0"></a>

На управляющей машине запущен бразуер и осуществлен вход на один из управляемых хостов.

<a href="https://ibb.co/51cgmkG"><img src="https://i.ibb.co/51cgmkG/7-2-3-4.png" alt="7-2-3-4" border="0"></a>

Проверка сайта через curl с ответом 200.
  
<a href="https://ibb.co/D585c9t"><img src="https://i.ibb.co/D585c9t/7-2-3-5.png" alt="7-2-3-5" border="0"></a>
